<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>MyEssantia · product · premium</title>
  
  <!-- Font Awesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <!-- Premium Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;1,400&family=Plus+Jakarta+Sans:wght@200;300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
  
  <style>
    /* ---------- BOLD, TEXTURED DESIGN FROM HOMEPAGE ---------- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html { scroll-behavior: smooth; }
    body { 
      overflow-x: hidden; 
      width: 100%; 
      font-family: 'Montserrat', sans-serif;
      background: #fcfaf7;
      color: #000;
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 16px;
    }

    /* ---------- BREADCRUMB ---------- */
    .breadcrumb {
      display: flex;
      gap: 8px;
      align-items: center;
      padding: 16px 0 16px;
      color: #666;
      font-size: 0.75rem;
      font-weight: 600;
      flex-wrap: wrap;
      text-transform: uppercase;
    }

    .breadcrumb a {
      color: #000;
      text-decoration: none;
      transition: color 0.2s;
      font-weight: 700;
    }

    .breadcrumb a:hover {
      color: #d4af37;
    }

    .breadcrumb i {
      font-size: 0.6rem;
      color: #d4af37;
    }

    /* ---------- MAIN GRID ---------- */
    .product-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;
      padding: 0 0 48px;
    }

    @media (min-width: 1024px) {
      .product-grid {
        grid-template-columns: 1fr 1fr;
        gap: 48px;
      }
    }

    /* ---------- GALLERY (BOLD FRAMES) ---------- */
    .gallery-section {
      width: 100%;
    }

    @media (min-width: 1024px) {
      .gallery-section {
        position: sticky;
        top: 24px;
        height: fit-content;
      }
    }

    .main-image {
      width: 100%;
      aspect-ratio: 1/1;
      border-radius: 24px;
      overflow: hidden;
      margin-bottom: 16px;
      background: #f8f6f2;
      border: 3px solid #000;
      box-shadow: 8px 8px 0 #000;
      transition: all 0.2s ease;
    }

    .main-image:hover {
      transform: translate(-2px, -2px);
      box-shadow: 12px 12px 0 #000;
    }

    .main-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .main-image:hover img {
      transform: scale(1.02);
    }

    .thumbnail-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }

    .thumbnail {
      aspect-ratio: 1/1;
      border-radius: 16px;
      overflow: hidden;
      cursor: pointer;
      border: 2px solid #000;
      transition: all 0.2s;
      background: #f8f6f2;
      box-shadow: 4px 4px 0 #000;
    }

    .thumbnail:hover,
    .thumbnail.active {
      transform: translate(-2px, -2px);
      box-shadow: 6px 6px 0 #d4af37;
      border-color: #d4af37;
    }

    .thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* ---------- REVIEWS UNDER GALLERY (DESKTOP) ---------- */
    .gallery-reviews {
      display: none;
      margin-top: 32px;
    }

    @media (min-width: 1024px) {
      .gallery-reviews {
        display: block;
      }
    }

    .reviews-mini {
      background: #000;
      border-radius: 24px;
      padding: 24px;
      border: 3px solid #d4af37;
      box-shadow: 8px 8px 0 #000;
      position: relative;
    }

    .reviews-mini::after {
      content: '';
      position: absolute;
      top: 6px; left: 6px; right: -6px; bottom: -6px;
      border: 2px solid #d4af37;
      border-radius: 22px;
      opacity: 0.5;
      pointer-events: none;
    }

    .reviews-mini-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .reviews-mini-header h4 {
      font-weight: 800;
      font-size: 1.2rem;
      color: #fff;
      text-transform: uppercase;
    }

    .reviews-mini-header span {
      color: #d4af37;
      font-weight: 800;
      background: #1a1a1a;
      padding: 4px 12px;
      border-radius: 40px;
      border: 1px solid #d4af37;
    }

    .review-mini-item {
      display: flex;
      gap: 12px;
      padding: 16px 0;
      border-bottom: 1px solid #333;
    }

    .review-mini-item:last-child {
      border-bottom: none;
    }

    .review-mini-avatar {
      width: 44px;
      height: 44px;
      background: #d4af37;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      color: #000;
      flex-shrink: 0;
      border: 2px solid #fff;
    }

    .review-mini-content {
      flex: 1;
    }

    .review-mini-name {
      font-weight: 700;
      font-size: 0.9rem;
      margin-bottom: 2px;
      color: #fff;
    }

    .review-mini-rating {
      color: #d4af37;
      font-size: 0.7rem;
      margin-bottom: 4px;
    }

    .review-mini-text {
      font-size: 0.8rem;
      color: #ccc;
      line-height: 1.4;
    }

    .view-all-reviews {
      text-align: center;
      margin-top: 20px;
      padding: 12px;
      background: #1a1a1a;
      border-radius: 40px;
      font-weight: 700;
      font-size: 0.9rem;
      color: #d4af37;
      cursor: pointer;
      transition: all 0.2s;
      border: 2px solid #d4af37;
      text-transform: uppercase;
    }

    .view-all-reviews:hover {
      background: #d4af37;
      color: #000;
      transform: translate(-2px, -2px);
      box-shadow: 4px 4px 0 #fff;
    }

    /* ---------- PRODUCT INFO ---------- */
    .product-info {
      padding: 0;
    }

    /* Social Proof Strip */
    .social-strip {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 20px;
    }

    .sold-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: #000;
      color: #fff;
      padding: 8px 16px;
      border-radius: 40px;
      font-size: 0.8rem;
      font-weight: 700;
      box-shadow: 4px 4px 0 #d4af37;
      border: 2px solid #d4af37;
      text-transform: uppercase;
    }

    .live-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: #d4af37;
      color: #000;
      padding: 8px 16px;
      border-radius: 40px;
      font-size: 0.8rem;
      font-weight: 800;
      box-shadow: 4px 4px 0 #000;
      border: 2px solid #000;
      text-transform: uppercase;
      animation: pulse 2s infinite;
    }

    .live-badge i {
      font-size: 0.5rem;
      color: #000;
      animation: blink 1.5s infinite;
    }

    @keyframes pulse {
      0% { box-shadow: 4px 4px 0 #000; }
      70% { box-shadow: 6px 6px 0 #000, 0 0 10px rgba(212, 175, 55, 0.5); }
      100% { box-shadow: 4px 4px 0 #000; }
    }

    @keyframes blink {
      0% { opacity: 1; }
      50% { opacity: 0.3; }
      100% { opacity: 1; }
    }

    .product-category {
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #d4af37;
      margin-bottom: 8px;
    }

    .product-title {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.2rem;
      font-weight: 800;
      line-height: 1.1;
      color: #000;
      margin-bottom: 16px;
      letter-spacing: -0.02em;
      text-transform: uppercase;
      word-break: break-word;
    }

    @media (min-width: 768px) {
      .product-title {
        font-size: 3rem;
      }
    }

    /* Rating Row */
    .rating-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 16px;
      margin-bottom: 24px;
    }

    .stars {
      display: flex;
      gap: 3px;
      color: #d4af37;
      font-size: 1rem;
    }

    .rating-value {
      font-weight: 800;
      color: #000;
      font-size: 0.9rem;
    }

    .reviews-count {
      color: #666;
      font-size: 0.85rem;
      font-weight: 600;
    }

    /* Share Button - Bold Style */
    .share-wrapper {
      position: relative;
      margin-left: auto;
    }

    .share-btn {
      background: #000;
      border: 2px solid #d4af37;
      padding: 10px 20px;
      border-radius: 40px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 800;
      font-size: 0.85rem;
      color: #fff;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 4px 4px 0 #000;
      text-transform: uppercase;
    }

    .share-btn:hover {
      transform: translate(-2px, -2px);
      box-shadow: 6px 6px 0 #d4af37;
    }

    .share-btn i {
      color: #d4af37;
    }

    .share-menu {
      position: absolute;
      top: calc(100% + 12px);
      right: 0;
      background: #000;
      border-radius: 20px;
      box-shadow: 8px 8px 0 #d4af37;
      padding: 20px;
      width: 280px;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      border: 2px solid #d4af37;
    }

    .share-menu.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .share-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin-bottom: 16px;
    }

    .share-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 12px 4px;
      border-radius: 12px;
      background: #1a1a1a;
      border: 1px solid #333;
      font-size: 0.65rem;
      font-weight: 700;
      color: #fff;
      cursor: pointer;
      transition: all 0.2s;
    }

    .share-option i {
      font-size: 1.1rem;
      color: #d4af37;
    }

    .share-option:hover {
      background: #d4af37;
      color: #000;
      transform: translate(-2px, -2px);
      box-shadow: 3px 3px 0 #fff;
    }

    .share-option:hover i {
      color: #000;
    }

    .copy-link {
      display: flex;
      gap: 4px;
    }

    .copy-link input {
      flex: 1;
      padding: 10px;
      border: 2px solid #d4af37;
      border-radius: 12px;
      font-size: 0.7rem;
      background: #1a1a1a;
      color: #fff;
      font-weight: 600;
    }

    .copy-btn {
      padding: 10px 16px;
      background: #d4af37;
      color: #000;
      border: none;
      border-radius: 12px;
      font-weight: 800;
      font-size: 0.7rem;
      cursor: pointer;
      transition: all 0.2s;
      border: 2px solid #d4af37;
      text-transform: uppercase;
    }

    .copy-btn:hover {
      background: #fff;
      transform: translate(-2px, -2px);
      box-shadow: 3px 3px 0 #d4af37;
    }

    /* Price Card - BOLD */
    .price-card {
      background: #000;
      border-radius: 24px;
      padding: 24px;
      margin-bottom: 24px;
      border: 3px solid #d4af37;
      box-shadow: 8px 8px 0 #000;
      position: relative;
    }

    .price-card::after {
      content: '';
      position: absolute;
      top: 6px; left: 6px; right: -6px; bottom: -6px;
      border: 2px solid #d4af37;
      border-radius: 22px;
      opacity: 0.5;
      pointer-events: none;
    }

    .price-header {
      display: flex;
      align-items: baseline;
      gap: 16px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    .current-price {
      font-size: 3rem;
      font-weight: 900;
      color: #fff;
      font-family: 'Montserrat', sans-serif;
      line-height: 1;
    }

    .inr-symbol {
      font-size: 2rem;
      font-weight: 700;
      color: #d4af37;
    }

    .original-price {
      font-size: 1.5rem;
      color: #666;
      text-decoration: line-through;
      font-weight: 600;
    }

    .discount {
      background: #d4af37;
      color: #000;
      padding: 6px 16px;
      border-radius: 40px;
      font-weight: 900;
      font-size: 0.9rem;
      border: 2px solid #fff;
      box-shadow: 3px 3px 0 #fff;
    }

    /* Price Options */
    .price-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-bottom: 20px;
    }

    .price-option {
      padding: 16px 12px;
      border-radius: 18px;
      text-align: center;
      border: 2px solid;
      transition: all 0.2s;
      box-shadow: 5px 5px 0 #000;
    }

    .price-option:hover {
      transform: translate(-3px, -3px);
      box-shadow: 8px 8px 0 #000;
    }

    .price-option.prepaid {
      background: #d4af37;
      border-color: #fff;
    }

    .price-option.prepaid .option-price {
      color: #000;
    }

    .price-option.cod {
      background: #1a1a1a;
      border-color: #d4af37;
    }

    .price-option.cod .option-price {
      color: #d4af37;
    }

    .option-label {
      font-size: 0.7rem;
      font-weight: 700;
      color: #fff;
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .price-option.prepaid .option-label {
      color: #000;
    }

    .option-price {
      font-size: 1.8rem;
      font-weight: 800;
      font-family: 'Montserrat', sans-serif;
      line-height: 1.2;
    }

    .option-save {
      font-size: 0.7rem;
      font-weight: 700;
      color: #000;
      background: #fff;
      display: inline-block;
      padding: 2px 10px;
      border-radius: 40px;
      margin-top: 4px;
    }

    .price-option.cod .option-note {
      font-size: 0.65rem;
      color: #999;
      margin-top: 4px;
    }

    .stock-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      background: #1a1a1a;
      border-radius: 40px;
      font-size: 0.8rem;
      font-weight: 700;
      border: 2px solid #d4af37;
      color: #fff;
    }

    .stock-badge.in-stock {
      color: #d4af37;
    }

    .stock-badge.low-stock {
      color: #ff9800;
    }

    /* Money Back Promise - BOLD */
    .promise-card {
      background: #d4af37;
      border-radius: 24px;
      padding: 24px;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 20px;
      position: relative;
      overflow: hidden;
      border: 3px solid #000;
      box-shadow: 8px 8px 0 #000;
    }

    .promise-card::after {
      content: '✓✓';
      position: absolute;
      right: -20px;
      bottom: -30px;
      font-size: 8rem;
      font-weight: 900;
      opacity: 0.1;
      color: #000;
      transform: rotate(-15deg);
    }

    .promise-icon {
      width: 70px;
      height: 70px;
      background: #000;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.2rem;
      color: #d4af37;
      border: 3px solid #fff;
      box-shadow: 5px 5px 0 #000;
      z-index: 2;
    }

    .promise-content h4 {
      font-size: 1.2rem;
      font-weight: 900;
      color: #000;
      margin-bottom: 4px;
      text-transform: uppercase;
    }

    .promise-content p {
      color: #000;
      font-size: 0.9rem;
      font-weight: 700;
    }

    .promise-highlight {
      background: #000;
      color: #d4af37;
      padding: 2px 8px;
      border-radius: 4px;
      font-weight: 900;
    }

    /* Delivery Card */
    .delivery-card {
      background: #000;
      border-radius: 24px;
      padding: 24px;
      margin-bottom: 24px;
      border: 3px solid #d4af37;
      box-shadow: 8px 8px 0 #000;
    }

    .delivery-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .delivery-title {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 800;
      color: #fff;
      font-size: 1.1rem;
      text-transform: uppercase;
    }

    .delivery-title i {
      color: #d4af37;
      font-size: 1.3rem;
    }

    .delivery-min {
      background: #1a1a1a;
      padding: 6px 18px;
      border-radius: 40px;
      font-size: 0.8rem;
      font-weight: 800;
      color: #d4af37;
      border: 2px solid #d4af37;
    }

    .progress-container {
      margin: 16px 0;
    }

    .progress-bar {
      height: 12px;
      background: #1a1a1a;
      border-radius: 20px;
      overflow: hidden;
      border: 2px solid #d4af37;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #d4af37, #f5d742);
      width: 0%;
      transition: width 0.3s ease;
      border-radius: 20px;
    }

    .delivery-message {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 16px;
      font-size: 0.9rem;
      font-weight: 700;
      color: #fff;
    }

    .delivery-message i {
      color: #d4af37;
    }

    .delivery-message.eligible i {
      color: #4caf50;
    }

    .cart-value {
      font-weight: 900;
      color: #d4af37;
      background: #1a1a1a;
      padding: 4px 12px;
      border-radius: 40px;
      border: 1px solid #d4af37;
    }

    /* Features Grid */
    .features-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 24px;
    }

    .feature-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      background: #000;
      border-radius: 20px;
      border: 2px solid #d4af37;
      box-shadow: 5px 5px 0 #000;
    }

    .feature-icon {
      width: 44px;
      height: 44px;
      background: #d4af37;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #000;
      font-size: 1.3rem;
      border: 2px solid #fff;
      box-shadow: 3px 3px 0 #000;
    }

    .feature-text h4 {
      font-weight: 800;
      font-size: 0.85rem;
      margin-bottom: 2px;
      color: #fff;
      text-transform: uppercase;
    }

    .feature-text p {
      font-size: 0.7rem;
      color: #999;
      font-weight: 600;
    }

    /* Quantity */
    .quantity-wrapper {
      background: #000;
      border-radius: 24px;
      padding: 24px;
      margin-bottom: 24px;
      border: 3px solid #d4af37;
      box-shadow: 8px 8px 0 #000;
    }

    .quantity-label {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 800;
      margin-bottom: 20px;
      color: #fff;
      text-transform: uppercase;
    }

    .quantity-label i {
      color: #d4af37;
    }

    .quantity-controls {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .qty-btn {
      width: 52px;
      height: 52px;
      border: 2px solid #d4af37;
      background: #1a1a1a;
      border-radius: 16px;
      font-size: 1.5rem;
      font-weight: 800;
      color: #fff;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 4px 4px 0 #000;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .qty-btn:hover:not(:disabled) {
      background: #d4af37;
      color: #000;
      transform: translate(-2px, -2px);
      box-shadow: 6px 6px 0 #000;
    }

    .qty-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .qty-input {
      width: 80px;
      height: 52px;
      border: 2px solid #d4af37;
      border-radius: 16px;
      text-align: center;
      font-size: 1.3rem;
      font-weight: 800;
      background: #fff;
      color: #000;
    }

    /* Action Buttons - BOLD */
    .action-buttons {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 32px;
    }

    @media (min-width: 480px) {
      .action-buttons {
        flex-direction: row;
      }
    }

    .btn {
      flex: 1;
      padding: 18px;
      border: none;
      border-radius: 40px;
      font-weight: 900;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      min-height: 60px;
    }

    .btn-primary {
      background: #d4af37;
      color: #000;
      border: 3px solid #000;
      box-shadow: 6px 6px 0 #000;
    }

    .btn-primary:hover {
      background: #fff;
      transform: translate(-3px, -3px);
      box-shadow: 10px 10px 0 #000;
    }

    .btn-secondary {
      background: #000;
      color: #fff;
      border: 3px solid #d4af37;
      box-shadow: 6px 6px 0 #000;
    }

    .btn-secondary:hover {
      background: #1a1a1a;
      transform: translate(-3px, -3px);
      box-shadow: 10px 10px 0 #d4af37;
    }

    /* Tabs */
    .tabs {
      background: #000;
      border-radius: 24px;
      padding: 24px;
      margin-bottom: 32px;
      border: 3px solid #d4af37;
      box-shadow: 8px 8px 0 #000;
    }

    .tab-headers {
      display: flex;
      gap: 20px;
      border-bottom: 3px solid #d4af37;
      margin-bottom: 24px;
      overflow-x: auto;
      padding-bottom: 4px;
      scrollbar-width: thin;
    }

    .tab-header {
      padding: 12px 0;
      cursor: pointer;
      font-weight: 800;
      color: #666;
      position: relative;
      transition: color 0.2s;
      font-size: 0.9rem;
      white-space: nowrap;
      text-transform: uppercase;
    }

    .tab-header:hover {
      color: #d4af37;
    }

    .tab-header.active {
      color: #d4af37;
    }

    .tab-header.active::after {
      content: '';
      position: absolute;
      bottom: -3px;
      left: 0;
      width: 100%;
      height: 3px;
      background: #d4af37;
    }

    .tab-content {
      display: none;
      line-height: 1.7;
      color: #fff;
      font-size: 0.9rem;
      font-weight: 500;
    }

    .tab-content.active {
      display: block;
    }

    .specs-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }

    @media (min-width: 480px) {
      .specs-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .spec-item {
      padding: 16px;
      background: #1a1a1a;
      border-radius: 16px;
      border: 2px solid #d4af37;
    }

    .spec-label {
      font-size: 0.7rem;
      color: #999;
      margin-bottom: 4px;
      text-transform: uppercase;
      font-weight: 600;
    }

    .spec-value {
      font-weight: 800;
      color: #fff;
      font-size: 1rem;
    }

    .video-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }

    @media (min-width: 480px) {
      .video-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .video-item {
      aspect-ratio: 16/9;
      border-radius: 16px;
      overflow: hidden;
      position: relative;
      cursor: pointer;
      border: 2px solid #d4af37;
      box-shadow: 5px 5px 0 #000;
    }

    .video-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .video-item i {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 50px;
      height: 50px;
      background: #d4af37;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #000;
      font-size: 1.2rem;
      border: 3px solid #000;
      box-shadow: 4px 4px 0 #000;
    }

    .video-duration {
      position: absolute;
      bottom: 8px;
      right: 8px;
      background: #000;
      color: #d4af37;
      padding: 4px 10px;
      border-radius: 40px;
      font-size: 0.7rem;
      font-weight: 700;
      border: 1px solid #d4af37;
    }

    /* Reviews Section (Mobile) */
    .reviews-section {
      background: #000;
      border-radius: 24px;
      padding: 24px;
      margin-bottom: 32px;
      border: 3px solid #d4af37;
      box-shadow: 8px 8px 0 #000;
    }

    .reviews-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .reviews-title {
      font-size: 1.3rem;
      font-weight: 800;
      color: #fff;
      text-transform: uppercase;
    }

    .reviews-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }

    @media (min-width: 640px) {
      .reviews-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .review-card {
      padding: 20px;
      background: #1a1a1a;
      border-radius: 20px;
      border: 2px solid #d4af37;
      box-shadow: 5px 5px 0 #000;
    }

    .reviewer {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .reviewer-avatar {
      width: 48px;
      height: 48px;
      background: #d4af37;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      color: #000;
      border: 2px solid #fff;
    }

    .reviewer-info h5 {
      font-weight: 800;
      font-size: 1rem;
      color: #fff;
    }

    .reviewer-info span {
      font-size: 0.7rem;
      color: #999;
      font-weight: 600;
    }

    .review-rating {
      color: #d4af37;
      font-size: 0.8rem;
      margin-bottom: 10px;
    }

    .review-text {
      font-size: 0.9rem;
      color: #ccc;
      margin-bottom: 16px;
      line-height: 1.5;
      font-style: italic;
    }

    .review-helpful {
      display: flex;
      gap: 20px;
      font-size: 0.75rem;
      color: #666;
      font-weight: 600;
    }

    .review-helpful i {
      margin-right: 4px;
      color: #d4af37;
    }

    /* Related Products */
    .related {
      margin-top: 48px;
      padding-top: 32px;
      border-top: 4px solid #000;
    }

    .related-title {
      font-size: 1.8rem;
      font-weight: 900;
      font-family: 'Montserrat', sans-serif;
      margin-bottom: 24px;
      text-transform: uppercase;
    }

    .related-title span {
      color: #d4af37;
    }

    .related-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }

    @media (min-width: 640px) {
      .related-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
      }
    }

    .related-card {
      text-decoration: none;
      color: inherit;
      background: #000;
      border-radius: 20px;
      padding: 16px;
      border: 2px solid #d4af37;
      transition: all 0.2s;
      box-shadow: 6px 6px 0 #000;
      display: block;
    }

    .related-card:hover {
      transform: translate(-4px, -4px);
      box-shadow: 10px 10px 0 #d4af37;
    }

    .related-image {
      aspect-ratio: 1/1;
      border-radius: 16px;
      overflow: hidden;
      margin-bottom: 12px;
      background: #1a1a1a;
      border: 2px solid #d4af37;
    }

    .related-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .related-category {
      font-size: 0.6rem;
      font-weight: 700;
      color: #d4af37;
      text-transform: uppercase;
      margin-bottom: 4px;
    }

    .related-name {
      font-weight: 800;
      font-size: 0.8rem;
      margin-bottom: 6px;
      color: #fff;
      line-height: 1.3;
    }

    .related-price {
      font-weight: 900;
      color: #d4af37;
      font-size: 1.1rem;
      margin-bottom: 10px;
    }

    .related-add {
      padding: 10px;
      background: #1a1a1a;
      border-radius: 40px;
      text-align: center;
      font-size: 0.7rem;
      font-weight: 800;
      color: #fff;
      transition: all 0.2s;
      border: 1px solid #d4af37;
      cursor: pointer;
      text-transform: uppercase;
    }

    .related-card:hover .related-add {
      background: #d4af37;
      color: #000;
    }

    /* Notification */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      left: 20px;
      background: #000;
      border-radius: 60px;
      padding: 16px 24px;
      box-shadow: 8px 8px 0 #d4af37;
      display: flex;
      align-items: center;
      gap: 16px;
      font-weight: 800;
      z-index: 1000;
      animation: slideIn 0.3s ease;
      border: 3px solid #d4af37;
      color: #fff;
      max-width: 400px;
      margin: 0 auto;
    }

    @media (min-width: 640px) {
      .notification {
        left: auto;
        width: auto;
      }
    }

    .notification i {
      color: #d4af37;
      font-size: 1.3rem;
    }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* Mobile Only Class */
    @media (min-width: 1024px) {
      .mobile-only {
        display: none;
      }
    }

    /* Scroll Top Button (from homepage) */
    .scroll-top {
      position: fixed; 
      bottom: 20px; 
      right: 16px; 
      background: #000; 
      color: #d4af37;
      width: 52px; 
      height: 52px; 
      border-radius: 50%; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      border: 3px solid #d4af37; 
      box-shadow: 4px 4px 0 #000;
      opacity: 0; 
      transform: translateY(15px); 
      transition: 0.2s; 
      z-index: 100;
      font-size: 1.4rem; 
      cursor: pointer;
    }

    .scroll-top.visible { 
      opacity: 1; 
      transform: translateY(0); 
    }

    .scroll-top:active { 
      background: #d4af37; 
      color: #000; 
      transform: scale(0.9); 
    }

    /* Mobile optimizations */
    @media (max-width: 480px) {
      .product-title {
        font-size: 1.8rem;
      }
      
      .current-price {
        font-size: 2.4rem;
      }
      
      .option-price {
        font-size: 1.4rem;
      }
      
      .feature-item {
        padding: 12px;
      }
      
      .btn {
        padding: 14px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>

  <div id="header"></div>
  <button class="scroll-top" id="scrollTop" onclick="window.scrollTo({top:0,behavior:'smooth'})"><i class="fa-solid fa-arrow-up"></i></button>

  <main>
    <div class="container">
      <div class="breadcrumb">
        <a href="index.html">HOME</a>
        <i class="fa-solid fa-chevron-right"></i>
        <a href="collection.html">COLLECTION</a>
        <i class="fa-solid fa-chevron-right"></i>
        <span id="breadcrumb-product">LOADING...</span>
      </div>
    </div>

    <div class="container" id="product-container"></div>
  </main>

  <div id="footer"></div>

  <script>
    // ========== FIREBASE CONFIG ==========
    const firebaseConfig = {
      apiKey: "AIzaSyD16uGnm1vodkbqGoFSdFdJjGFSLpJmflk",
      authDomain: "myessantia.firebaseapp.com",
      projectId: "myessantia",
      storageBucket: "myessantia.firebasestorage.app",
      messagingSenderId: "701726517205",
      appId: "1:701726517205:web:f6ab79efdffeab6dbbbf5c"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ========== GLOBAL ==========
    let currentProduct = null;
    let cart = JSON.parse(localStorage.getItem('myessantia_cart')) || [];

    // Generate random values (with bold numbers)
    function getRandomSold() {
      return Math.floor(Math.random() * (2500 - 800 + 1)) + 800;
    }

    function getRandomViewers() {
      return Math.floor(Math.random() * (45 - 12 + 1)) + 12;
    }

    function generateReviews() {
      const users = [
        { name: 'PRIYA SHARMA', city: 'MUMBAI', avatar: 'PS' },
        { name: 'RAHUL VERMA', city: 'DELHI', avatar: 'RV' },
        { name: 'ANANYA PATEL', city: 'BANGALORE', avatar: 'AP' },
        { name: 'KARTHIK IYER', city: 'CHENNAI', avatar: 'KI' },
        { name: 'NEHA GUPTA', city: 'PUNE', avatar: 'NG' },
        { name: 'ARJUN SINGH', city: 'HYDERABAD', avatar: 'AS' },
        { name: 'DIVYA NAIR', city: 'KOCHI', avatar: 'DN' },
        { name: 'VIKRAM MEHTA', city: 'AHMEDABAD', avatar: 'VM' }
      ];
      
      const comments = [
        "ABSOLUTELY LOVE THIS! QUALITY IS AMAZING AND DELIVERY WAS SUPER FAST.",
        "PERFECT PRODUCT, EXCEEDED MY EXPECTATIONS. WORTH EVERY PENNY!",
        "GREAT QUALITY AND BEAUTIFUL DESIGN. MY FRIENDS KEEP ASKING WHERE I GOT IT.",
        "EXACTLY AS DESCRIBED. THE MATERIAL IS PREMIUM AND IT LOOKS EVEN BETTER IN PERSON.",
        "EXCELLENT CUSTOMER SERVICE AND QUICK SHIPPING. VERY HAPPY WITH PURCHASE.",
        "THE ATTENTION TO DETAIL IS IMPRESSIVE. DEFINITELY BUYING MORE FROM THIS BRAND.",
        "GOOD VALUE FOR MONEY. THE PRODUCT FEELS VERY PREMIUM.",
        "FAST DELIVERY AND GREAT PACKAGING. WILL RECOMMEND TO OTHERS!"
      ];
      
      return users.map((user, i) => ({
        ...user,
        comment: comments[i % comments.length],
        rating: (4 + Math.random() * 0.9).toFixed(1),
        time: Math.floor(Math.random() * 48) + 1,
        helpful: Math.floor(Math.random() * 40) + 15
      }));
    }

    function getProductId() {
      return new URLSearchParams(window.location.search).get('id');
    }

    async function loadProduct() {
      const productId = getProductId();
      if (!productId) return showNotFound();

      try {
        const doc = await db.collection('products').doc(productId).get();
        if (!doc.exists) return showNotFound();

        currentProduct = { id: doc.id, ...doc.data() };
        document.getElementById('breadcrumb-product').textContent = currentProduct.title.toUpperCase();
        renderProduct(currentProduct);
        loadRelated(currentProduct);
      } catch (error) {
        console.error(error);
        showNotFound();
      }
    }

    function showNotFound() {
      document.getElementById('product-container').innerHTML = `
        <div style="text-align: center; padding: 60px 20px; background: #000; border-radius: 32px; border: 4px solid #d4af37; box-shadow: 12px 12px 0 #000;">
          <i class="fa-solid fa-box-open" style="font-size: 64px; color: #d4af37;"></i>
          <h2 style="font-size: 2rem; margin: 20px 0; color: #fff; font-weight: 900;">PRODUCT NOT FOUND</h2>
          <p style="color: #999; margin-bottom: 30px;">The product you're looking for doesn't exist.</p>
          <a href="collection.html" style="display: inline-block; padding: 16px 40px; background: #d4af37; color: #000; text-decoration: none; border-radius: 60px; font-weight: 900; border: 3px solid #000; box-shadow: 6px 6px 0 #000;">BROWSE COLLECTION</a>
        </div>
      `;
    }

    function renderProduct(product) {
      const images = [];
      if (product.media?.images) images.push(...product.media.images.map(i => i.url));
      if (images.length === 0) images.push(product.primaryImg || 'https://images.unsplash.com/photo-1578500494198-246f612d3b3d?w=600');

      const stock = product.stock || 10;
      const originalPrice = Math.round(product.price * 1.25);
      const discount = Math.round(((originalPrice - product.price) / originalPrice) * 100);
      const prepaidPrice = Math.round(product.price * 0.92); // 8% discount
      const codPrice = Math.round(product.price * 1.04); // 4% extra
      
      const quantity = 1;
      const soldCount = getRandomSold();
      const liveViewers = getRandomViewers();
      const reviews = generateReviews();

      const container = document.getElementById('product-container');
      container.innerHTML = `
        <div class="product-grid">
          <!-- Gallery Section -->
          <div class="gallery-section">
            <div class="main-image">
              <img src="${images[0]}" alt="${product.title}" id="mainImage">
            </div>
            <div class="thumbnail-grid">
              ${images.map((img, i) => `
                <div class="thumbnail ${i === 0 ? 'active' : ''}" onclick="changeImage('${img}', this)">
                  <img src="${img}" alt="thumb">
                </div>
              `).join('')}
            </div>
            
            <!-- Desktop Reviews -->
            <div class="gallery-reviews">
              <div class="reviews-mini">
                <div class="reviews-mini-header">
                  <h4>REAL REVIEWS</h4>
                  <span>★ ${(product.rating || 4.5).toFixed(1)}</span>
                </div>
                ${reviews.slice(0, 3).map(r => `
                  <div class="review-mini-item">
                    <div class="review-mini-avatar">${r.avatar}</div>
                    <div class="review-mini-content">
                      <div class="review-mini-name">${r.name}</div>
                      <div class="review-mini-rating">
                        ${'★'.repeat(Math.floor(r.rating))}${r.rating % 1 ? '½' : ''}
                      </div>
                      <div class="review-mini-text">"${r.comment.substring(0, 60)}..."</div>
                    </div>
                  </div>
                `).join('')}
                <div class="view-all-reviews">VIEW ALL 128 REVIEWS →</div>
              </div>
            </div>
          </div>

          <!-- Product Info -->
          <div class="product-info">
            <!-- Social Strip -->
            <div class="social-strip">
              <span class="sold-badge">
                <i class="fa-solid fa-fire"></i> ${soldCount}+ SOLD
              </span>
              <span class="live-badge">
                <i class="fa-solid fa-circle"></i> ${liveViewers} VIEWING NOW
              </span>
            </div>

            <div class="product-category">${product.category?.toUpperCase() || 'ACCESSORIES'}</div>
            <h1 class="product-title">${product.title}</h1>

            <!-- Rating & Share -->
            <div class="rating-row">
              <div class="stars">
                ${getStars(product.rating)}
              </div>
              <span class="rating-value">${(product.rating || 4.5).toFixed(1)}</span>
              <span class="reviews-count">(128 REVIEWS)</span>
              
              <div class="share-wrapper">
                <button class="share-btn" onclick="toggleShare(event)">
                  <i class="fa-solid fa-share-alt"></i> SHARE
                </button>
                <div class="share-menu" id="shareMenu">
                  <div class="share-grid">
                    <button class="share-option" onclick="share('facebook')"><i class="fa-brands fa-facebook-f"></i>FB</button>
                    <button class="share-option" onclick="share('twitter')"><i class="fa-brands fa-x-twitter"></i>TW</button>
                    <button class="share-option" onclick="share('whatsapp')"><i class="fa-brands fa-whatsapp"></i>WA</button>
                    <button class="share-option" onclick="share('telegram')"><i class="fa-brands fa-telegram"></i>TG</button>
                    <button class="share-option" onclick="share('email')"><i class="fa-regular fa-envelope"></i>MAIL</button>
                    <button class="share-option" onclick="share('pinterest')"><i class="fa-brands fa-pinterest"></i>PIN</button>
                  </div>
                  <div class="copy-link">
                    <input type="text" id="shareLink" value="${window.location.href}" readonly>
                    <button class="copy-btn" onclick="copyLink()">COPY</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Price Card -->
            <div class="price-card">
              <div class="price-header">
                <span class="current-price"><span class="inr-symbol">₹</span>${product.price.toFixed(2)}</span>
                <span class="original-price">₹${originalPrice.toFixed(2)}</span>
                <span class="discount">-${discount}%</span>
              </div>
              
              <div class="price-options">
                <div class="price-option prepaid">
                  <div class="option-label">PREPAID</div>
                  <div class="option-price">₹${prepaidPrice}</div>
                  <div class="option-save">SAVE ₹${product.price - prepaidPrice}</div>
                </div>
                <div class="price-option cod">
                  <div class="option-label">CASH ON DELIVERY</div>
                  <div class="option-price">₹${codPrice}</div>
                  <div class="option-note">+₹${codPrice - product.price} FEE</div>
                </div>
              </div>

              <span class="stock-badge ${stock > 10 ? 'in-stock' : 'low-stock'}">
                <i class="fa-solid ${stock > 10 ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
                ${stock > 10 ? 'IN STOCK' : `ONLY ${stock} LEFT`}
              </span>
            </div>

            <!-- Money Back Promise -->
            <div class="promise-card">
              <div class="promise-icon">
                <i class="fa-solid fa-shield"></i>
              </div>
              <div class="promise-content">
                <h4>RAZORPAY MONEY BACK</h4>
                <p><span class="promise-highlight">100% REFUND</span> ON NON-DELIVERY OR DEFECTS</p>
              </div>
            </div>

            <!-- Delivery Card -->
            <div class="delivery-card" id="deliveryCard">
              <div class="delivery-header">
                <span class="delivery-title">
                  <i class="fa-solid fa-truck"></i> FREE DELIVERY
                </span>
                <span class="delivery-min">MIN. ₹1,299</span>
              </div>
              
              <div class="progress-container">
                <div class="progress-bar">
                  <div class="progress-fill" id="deliveryProgress" style="width: ${Math.min(100, (product.price / 1299) * 100)}%"></div>
                </div>
              </div>
              
              <div class="delivery-message" id="deliveryMessage">
                <i class="fa-solid ${product.price >= 1299 ? 'fa-circle-check' : 'fa-circle-info'}"></i>
                <span id="deliveryText">
                  ${product.price >= 1299 
                    ? 'YOU GET FREE DELIVERY!' 
                    : `ADD <span class="cart-value">₹${(1299 - product.price).toFixed(2)}</span> MORE`}
                </span>
              </div>
            </div>

            <!-- Features -->
            <div class="features-grid">
              <div class="feature-item">
                <div class="feature-icon"><i class="fa-solid fa-truck-fast"></i></div>
                <div>
                  <h4>FREE SHIPPING</h4>
                  <p>ABOVE ₹1,299</p>
                </div>
              </div>
              <div class="feature-item">
                <div class="feature-icon"><i class="fa-solid fa-rotate-left"></i></div>
                <div>
                  <h4>EASY RETURNS</h4>
                  <p>48 HOURS</p>
                </div>
              </div>
            </div>

            <!-- Quantity -->
            <div class="quantity-wrapper">
              <div class="quantity-label">
                <i class="fa-solid fa-cubes"></i> QUANTITY
              </div>
              <div class="quantity-controls">
                <button class="qty-btn" onclick="updateQuantity(-1)" ${stock === 0 ? 'disabled' : ''}>−</button>
                <input type="text" class="qty-input" id="productQuantity" value="1" readonly>
                <button class="qty-btn" onclick="updateQuantity(1)" ${stock === 0 ? 'disabled' : ''}>+</button>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
              <button class="btn btn-secondary" onclick="addToCart()" ${stock === 0 ? 'disabled' : ''}>
                <i class="fa-solid fa-cart-plus"></i> ADD TO CART
              </button>
              <button class="btn btn-primary" onclick="buyNow()" ${stock === 0 ? 'disabled' : ''}>
                <i class="fa-solid fa-bolt"></i> BUY NOW
              </button>
            </div>

            <!-- Tabs -->
            <div class="tabs">
              <div class="tab-headers">
                <div class="tab-header active" onclick="switchTab('desc')">DESCRIPTION</div>
                <div class="tab-header" onclick="switchTab('specs')">SPECS</div>
                <div class="tab-header" onclick="switchTab('videos')">VIDEOS</div>
              </div>
              <div class="tab-content active" id="tab-desc">
                <p>${product.description || product.shortDesc || 'PREMIUM QUALITY PRODUCT FROM MYESSANTIA. CRAFTED WITH ATTENTION TO DETAIL AND MADE FROM THE FINEST MATERIALS.'}</p>
              </div>
              <div class="tab-content" id="tab-specs">
                <div class="specs-grid">
                  <div class="spec-item">
                    <div class="spec-label">MATERIAL</div>
                    <div class="spec-value">PREMIUM QUALITY</div>
                  </div>
                  <div class="spec-item">
                    <div class="spec-label">BRAND</div>
                    <div class="spec-value">${product.brand?.toUpperCase() || 'MYESSANTIA'}</div>
                  </div>
                  <div class="spec-item">
                    <div class="spec-label">ORIGIN</div>
                    <div class="spec-value">MADE IN INDIA</div>
                  </div>
                  <div class="spec-item">
                    <div class="spec-label">WARRANTY</div>
                    <div class="spec-value">6 MONTHS</div>
                  </div>
                </div>
              </div>
              <div class="tab-content" id="tab-videos">
                <div class="video-grid">
                  <div class="video-item">
                    <img src="https://images.unsplash.com/photo-1578500494198-246f612d3b3d?w=400" alt="video">
                    <i class="fa-solid fa-play"></i>
                    <span class="video-duration">2:34</span>
                  </div>
                  <div class="video-item">
                    <img src="https://images.unsplash.com/photo-1578500494198-246f612d3b3d?w=400" alt="video">
                    <i class="fa-solid fa-play"></i>
                    <span class="video-duration">1:47</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Mobile Reviews -->
            <div class="reviews-section mobile-only">
              <div class="reviews-header">
                <span class="reviews-title">CUSTOMER REVIEWS</span>
                <span>★ ${(product.rating || 4.5).toFixed(1)} · 128</span>
              </div>
              <div class="reviews-grid">
                ${reviews.slice(0, 4).map(r => `
                  <div class="review-card">
                    <div class="reviewer">
                      <div class="reviewer-avatar">${r.avatar}</div>
                      <div class="reviewer-info">
                        <h5>${r.name}</h5>
                        <span>${r.city} · ${r.time}H AGO</span>
                      </div>
                    </div>
                    <div class="review-rating">
                      ${'★'.repeat(Math.floor(r.rating))}${r.rating % 1 ? '½' : ''}
                    </div>
                    <div class="review-text">"${r.comment}"</div>
                    <div class="review-helpful">
                      <span><i class="fa-regular fa-thumbs-up"></i> ${r.helpful}</span>
                      <span><i class="fa-regular fa-comment"></i> REPLY</span>
                    </div>
                  </div>
                `).join('')}
              </div>
              <div class="view-all-reviews">VIEW ALL 128 REVIEWS →</div>
            </div>
          </div>
        </div>
      `;

      updateDeliveryBar(product.price);
      
      // Setup scroll top button
      setupScrollTop();
    }

    function setupScrollTop() {
      const btn = document.getElementById('scrollTop');
      window.addEventListener('scroll', () => {
        btn.classList.toggle('visible', window.scrollY > 200);
      });
    }

    async function loadRelated(product) {
      try {
        const snap = await db.collection('products')
          .where('category', '==', product.category)
          .limit(5)
          .get();
        
        const related = snap.docs
          .map(d => ({ id: d.id, ...d.data() }))
          .filter(p => p.id !== product.id)
          .slice(0, 4);

        if (related.length === 0) return;

        const html = `
          <div class="related">
            <h2 class="related-title"><span>YOU MAY</span> ALSO LIKE</h2>
            <div class="related-grid">
              ${related.map(p => {
                const img = p.media?.images?.[0]?.url || p.primaryImg || 'https://images.unsplash.com/photo-1578500494198-246f612d3b3d?w=200';
                return `
                  <a href="product.html?id=${p.id}" class="related-card">
                    <div class="related-image">
                      <img src="${img}" alt="${p.title}">
                    </div>
                    <div class="related-category">${p.category?.toUpperCase() || 'ACCESSORY'}</div>
                    <div class="related-name">${p.title.substring(0, 25).toUpperCase()}</div>
                    <div class="related-price">₹${p.price.toFixed(2)}</div>
                    <div class="related-add" onclick="event.stopPropagation(); quickAdd('${p.id}')">
                      <i class="fa-solid fa-cart-plus"></i> QUICK ADD
                    </div>
                  </a>
                `;
              }).join('')}
            </div>
          </div>
        `;
        
        document.getElementById('product-container').insertAdjacentHTML('beforeend', html);
      } catch (e) {
        console.error('Related error:', e);
      }
    }

    // Helper Functions
    function getStars(rating) {
      const r = parseFloat(rating) || 4.5;
      let stars = '';
      for (let i = 1; i <= 5; i++) {
        if (r >= i) stars += '<i class="fa-solid fa-star"></i>';
        else if (r > i-1 && r < i) stars += '<i class="fa-solid fa-star-half-alt"></i>';
        else stars += '<i class="fa-regular fa-star"></i>';
      }
      return stars;
    }

    window.changeImage = function(src, el) {
      document.getElementById('mainImage').src = src;
      document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
      el.classList.add('active');
    };

    window.updateQuantity = function(delta) {
      const input = document.getElementById('productQuantity');
      let val = parseInt(input.value) || 1;
      val += delta;
      if (val < 1) val = 1;
      if (currentProduct && val > currentProduct.stock) val = currentProduct.stock;
      input.value = val;
      
      if (currentProduct) {
        const total = currentProduct.price * val;
        updateDeliveryBar(total);
      }
    };

    function updateDeliveryBar(total) {
      const progress = document.getElementById('deliveryProgress');
      const message = document.getElementById('deliveryMessage');
      const text = document.getElementById('deliveryText');
      if (!progress || !message || !text) return;

      const percent = Math.min(100, (total / 1299) * 100);
      progress.style.width = percent + '%';

      if (total >= 1299) {
        message.className = 'delivery-message eligible';
        message.querySelector('i').className = 'fa-solid fa-circle-check';
        text.innerHTML = 'YOU GET FREE DELIVERY!';
      } else {
        message.className = 'delivery-message';
        message.querySelector('i').className = 'fa-solid fa-circle-info';
        text.innerHTML = `ADD <span class="cart-value">₹${(1299 - total).toFixed(2)}</span> MORE`;
      }
    }

    // Share Functions
    window.toggleShare = function(e) {
      e.stopPropagation();
      const menu = document.getElementById('shareMenu');
      menu.classList.toggle('show');
      if (menu.classList.contains('show')) {
        setTimeout(() => document.addEventListener('click', closeShare), 100);
      }
    };

    function closeShare(e) {
      const menu = document.getElementById('shareMenu');
      const btn = document.querySelector('.share-btn');
      if (menu && !menu.contains(e.target) && !btn.contains(e.target)) {
        menu.classList.remove('show');
        document.removeEventListener('click', closeShare);
      }
    }

    window.share = function(platform) {
      const url = encodeURIComponent(window.location.href);
      const title = encodeURIComponent(currentProduct?.title || 'Product');
      let link = '';
      if (platform === 'facebook') link = `https://facebook.com/sharer/sharer.php?u=${url}`;
      if (platform === 'twitter') link = `https://twitter.com/intent/tweet?text=${title}&url=${url}`;
      if (platform === 'whatsapp') link = `https://wa.me/?text=${title}%20${url}`;
      if (platform === 'telegram') link = `https://t.me/share/url?url=${url}&text=${title}`;
      if (platform === 'email') link = `mailto:?subject=${title}&body=${url}`;
      if (platform === 'pinterest') link = `https://pinterest.com/pin/create/button/?url=${url}&description=${title}`;
      if (link) window.open(link, '_blank', 'width=600,height=400');
      document.getElementById('shareMenu')?.classList.remove('show');
    };

    window.copyLink = function() {
      const input = document.getElementById('shareLink');
      input.select();
      navigator.clipboard.writeText(input.value).then(() => {
        const btn = document.querySelector('.copy-btn');
        btn.textContent = 'COPIED!';
        setTimeout(() => {
          btn.textContent = 'COPY';
        }, 2000);
      });
    };

    // Cart Functions
    window.addToCart = function() {
      showNotification('PRODUCT ADDED TO CART!');
      
      const btn = event?.target?.closest('button');
      if (btn && btn.classList.contains('btn-secondary')) {
        const original = btn.innerHTML;
        btn.innerHTML = '<i class="fa-solid fa-check"></i> ADDED!';
        btn.style.background = '#d4af37';
        btn.style.color = '#000';
        btn.style.borderColor = '#000';
        setTimeout(() => {
          btn.innerHTML = original;
          btn.style.background = '';
          btn.style.color = '';
          btn.style.borderColor = '';
        }, 1500);
      }
    };

    window.buyNow = function() {
      addToCart();
      setTimeout(() => {
        window.location.href = 'checkout.html';
      }, 800);
    };

    window.quickAdd = function(id) {
      showNotification('QUICK ADD - COMING SOON!');
    };

    function showNotification(msg) {
      const existing = document.querySelector('.notification');
      if (existing) existing.remove();

      const notif = document.createElement('div');
      notif.className = 'notification';
      notif.innerHTML = `<i class="fa-solid fa-check-circle"></i> ${msg}`;
      document.body.appendChild(notif);
      setTimeout(() => notif.remove(), 3000);
    }

    // Tabs
    window.switchTab = function(tab) {
      document.querySelectorAll('.tab-header').forEach(h => h.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      document.querySelector(`.tab-header[onclick="switchTab('${tab}')"]`).classList.add('active');
      document.getElementById(`tab-${tab}`).classList.add('active');
    };

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      loadProduct();
      setupScrollTop();
    });
  </script>
</body>
</html>
