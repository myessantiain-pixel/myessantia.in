<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>MyEssantia · product · essential</title>
  
  <!-- Font Awesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <!-- Simple font: Inter only -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,300..700&display=swap" rel="stylesheet">
  
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
  
  <!-- Common CSS (linked exactly like sample page) -->
  <link rel="stylesheet" href="common.css">
  <link rel="stylesheet" href="header.css">
  <link rel="stylesheet" href="footer.css">
  
  <style>
    /* ========== ADDITIONAL PRODUCT PAGE STYLES – restructured layout ========== */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; overflow-x: hidden; background: #ffffff; scroll-behavior: smooth; }
    body {
      font-family: 'Inter', sans-serif;
      color: #1e1e1e;
      line-height: 1.5;
    }
    .container { width: 100%; max-width: 1280px; margin: 0 auto; padding: 0 20px; }
    @media (min-width: 640px) { .container { padding: 0 32px; } }

    /* active nav style */
    .nav-link.active { color: #d4af37 !important; font-weight: 700; position: relative; }
    .nav-link.active::after {
      content: ''; position: absolute; bottom: -5px; left: 0; width: 100%; height: 3px;
      background: #d4af37; animation: slideIn 0.3s ease;
    }
    @keyframes slideIn { from { width: 0; opacity: 0; } to { width: 100%; opacity: 1; } }

    /* breadcrumb */
    .breadcrumb {
      display: flex; flex-wrap: wrap; align-items: center; gap: 8px;
      padding: 20px 0; font-size: 0.85rem; color: #4a4a4a;
    }
    .breadcrumb a { color: #1e1e1e; text-decoration: none; font-weight: 600; transition: color 0.2s; }
    .breadcrumb a:hover { color: #d4af37; }
    .breadcrumb i { font-size: 0.7rem; color: #d4af37; }

    /* main grid */
    .product-grid {
      display: grid; grid-template-columns: 1fr; gap: 32px; padding-bottom: 60px;
    }
    @media (min-width: 1024px) {
      .product-grid { grid-template-columns: 1fr 1fr; gap: 60px; }
    }

    /* gallery */
    .gallery-section { width: 100%; }
    @media (min-width: 1024px) { .gallery-section { position: sticky; top: 20px; height: fit-content; } }
    .main-image {
      width: 100%; aspect-ratio: 1/1; border-radius: 28px; overflow: hidden; margin-bottom: 16px;
      background: #ffffff; border: 2px solid #000000; box-shadow: 8px 8px 0 rgba(0,0,0,0.2);
      transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
    }
    .main-image:hover { transform: scale(1.01) translate(-2px, -2px); box-shadow: 12px 12px 0 rgba(212,175,55,0.3); }
    .main-image img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.6s; }
    .main-image:hover img { transform: scale(1.05); }
    .thumbnail-grid {
      display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;
    }
    .thumbnail {
      aspect-ratio: 1/1; border-radius: 16px; overflow: hidden; cursor: pointer;
      border: 2px solid #000; transition: all 0.2s;
    }
    .thumbnail:hover { border-color: #d4af37; transform: translateY(-2px) scale(0.98); }
    .thumbnail.active { border-color: #d4af37; border-width: 3px; box-shadow: 0 0 0 2px rgba(212,175,55,0.3); }

    /* desktop reviews */
    .desktop-reviews { display: none; margin-top: 24px; }
    @media (min-width: 1024px) { .desktop-reviews { display: block; } }
    .review-mini-card {
      background: #ffffff; border-radius: 28px; padding: 24px;
      border: 2px solid #000; box-shadow: 6px 6px 0 rgba(0,0,0,0.1);
      transition: all 0.3s;
    }
    .review-mini-card:hover { box-shadow: 10px 10px 0 rgba(212,175,55,0.2); transform: translate(-2px, -2px); }

    /* product info */
    .social-strip { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 16px; }
    .sold-badge, .live-badge {
      display: inline-flex; align-items: center; gap: 8px; padding: 8px 18px; border-radius: 60px;
      font-size: 0.9rem; font-weight: 700; border: 2px solid #000; box-shadow: 3px 3px 0 rgba(0,0,0,0.2);
    }
    .sold-badge { background: #dc2626; color: white; animation: pulse-red 2s infinite; }
    .live-badge { background: #16a34a; color: white; animation: pulse-green 2s infinite; }
    @keyframes pulse-red { 0% { box-shadow: 0 0 0 0 rgba(220,38,38,0.5); } 70% { box-shadow: 0 0 0 8px rgba(220,38,38,0); } 100% { box-shadow: 0 0 0 0 rgba(220,38,38,0); } }
    @keyframes pulse-green { 0% { box-shadow: 0 0 0 0 rgba(22,163,74,0.5); } 70% { box-shadow: 0 0 0 8px rgba(22,163,74,0); } 100% { box-shadow: 0 0 0 0 rgba(22,163,74,0); } }

    .product-category {
      font-size: 0.85rem; font-weight: 700; color: #d4af37; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;
    }
    .product-title {
      font-size: 2.4rem; font-weight: 800; line-height: 1.1; margin-bottom: 16px; color: #000; text-transform: uppercase;
    }
    @media (min-width: 768px) { .product-title { font-size: 3rem; } }

    .rating-row {
      display: flex; flex-wrap: wrap; align-items: center; gap: 16px; margin-bottom: 24px;
    }
    .stars { display: flex; gap: 4px; color: #d4af37; font-size: 1rem; }

    /* share */
    .share-wrapper { position: relative; margin-left: auto; }
    .share-btn {
      background: #ffffff; border: 2px solid #000; padding: 8px 20px; border-radius: 60px;
      font-size: 0.9rem; font-weight: 700; cursor: pointer; transition: all 0.2s;
      display: flex; align-items: center; gap: 8px;
    }
    .share-btn:hover { border-color: #d4af37; background: #000; color: #d4af37; transform: translateY(-2px); }
    .share-menu {
      position: absolute; top: calc(100% + 10px); right: 0; background: white; border-radius: 24px;
      box-shadow: 8px 8px 0 rgba(0,0,0,0.2); padding: 20px; width: 280px; z-index: 100;
      opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.3s; border: 2px solid #000;
    }
    .share-menu.show { opacity: 1; visibility: visible; transform: translateY(0); }

    /* ========== PRICE CARD – with integrated quantity row ========== */
    .price-card {
      background: #ffffff; border-radius: 28px; padding: 24px; margin-bottom: 24px;
      border: 2px solid #000; box-shadow: 8px 8px 0 rgba(0,0,0,0.1);
      transition: all 0.3s;
    }
    .price-card:hover { box-shadow: 12px 12px 0 rgba(212,175,55,0.3); transform: translate(-2px, -2px); }
    .price-header {
      display: flex; align-items: baseline; gap: 16px; flex-wrap: wrap; margin-bottom: 8px;
    }
    .current-price {
      font-size: 2.8rem; font-weight: 900; color: #000; line-height: 1;
    }
    .inr-symbol { font-size: 1.8rem; font-weight: 700; color: #d4af37; }
    .original-price { font-size: 1.2rem; color: #777; text-decoration: line-through; }
    .discount {
      background: #000; color: #d4af37; padding: 4px 14px; border-radius: 60px;
      font-weight: 800; font-size: 1rem; border: 2px solid #d4af37;
    }
    .tax-info {
      font-size: 0.85rem; color: #4a4a4a; margin-bottom: 16px; border-bottom: 1px dashed #ccc; padding-bottom: 12px;
    }
    .tax-info i { color: #d4af37; margin-right: 6px; }

    /* price options – smaller boxes */
    .price-options {
      display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;
    }
    .price-option {
      padding: 10px 8px; border-radius: 18px; text-align: center; border: 2px solid;
      transition: all 0.2s; cursor: pointer; /* added cursor for clickability */
    }
    .price-option:hover { transform: translateY(-2px); border-color: #d4af37; }
    .price-option.prepaid { background: #fcf8f0; border-color: #d4af37; }
    .price-option.cod { background: #f4f4f4; border-color: #000; }
    .option-label { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; margin-bottom: 2px; }
    .option-price { font-size: 1.4rem; font-weight: 800; color: #000; line-height: 1.2; }

    /* quantity row inside price card */
    .quantity-stock-row {
      display: flex; align-items: center; justify-content: space-between; margin-top: 12px; padding-top: 12px;
      border-top: 1px dashed #ccc;
    }
    .quantity-controls {
      display: flex; align-items: center; gap: 8px;
    }
    .qty-btn {
      width: 36px; height: 36px; border: 2px solid #000; background: #ffffff; border-radius: 12px;
      font-size: 1.2rem; font-weight: 800; cursor: pointer; transition: all 0.2s;
    }
    .qty-btn:hover:not(:disabled) { background: #d4af37; border-color: #000; transform: scale(0.95); }
    .qty-btn:disabled { opacity: 0.4; cursor: not-allowed; }
    .qty-input {
      width: 50px; height: 36px; border: 2px solid #000; border-radius: 12px; text-align: center;
      font-size: 1rem; font-weight: 700; background: #ffffff;
    }
    .stock-badge-inline {
      display: inline-flex; align-items: center; gap: 6px; padding: 6px 14px;
      background: #ffffff; border-radius: 60px; font-size: 0.85rem; font-weight: 700;
      border: 2px solid #000;
    }

    /* ===== NEW BOX: delivery bar + razorpay + features grouped ===== */
    .info-group-card {
      background: #ffffff; border-radius: 28px; padding: 24px; margin-bottom: 24px;
      border: 2px solid #000; box-shadow: 8px 8px 0 rgba(0,0,0,0.1);
      transition: all 0.3s;
    }
    .info-group-card:hover { box-shadow: 12px 12px 0 rgba(212,175,55,0.3); transform: translate(-2px, -2px); }

    /* delivery bar on top inside group */
    .delivery-bar {
      margin-bottom: 24px;
    }
    .delivery-header {
      display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap;
    }
    .delivery-title { display: flex; align-items: center; gap: 8px; font-weight: 700; }
    .delivery-title i { color: #d4af37; }
    .delivery-min { background: #000; color: #d4af37; padding: 4px 14px; border-radius: 60px; font-weight: 600; }
    .progress-bar { height: 10px; background: #eaeaea; border-radius: 10px; overflow: hidden; margin: 8px 0; border: 1px solid #000; }
    .progress-fill { height: 100%; background: #d4af37; width: 0%; transition: width 0.5s; }
    .delivery-message { display: flex; align-items: center; gap: 8px; font-weight: 600; margin-bottom: 8px; }
    .delivery-eta {
      display: flex; align-items: center; gap: 8px; font-size: 0.95rem; color: #1e1e1e;
    }
    .delivery-eta i { color: #d4af37; width: 20px; }
    .eta-bold { font-weight: 800; color: #000; }

    /* razorpay promise + feature items in a 2-col layout */
    .promise-features-row {
      display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-items: center;
      margin-top: 8px;
    }
    .razorpay-promise {
      background: #000; border-radius: 20px; padding: 16px;
      display: flex; align-items: center; gap: 12px; border: 2px solid #d4af37;
      transition: all 0.3s;
    }
    .razorpay-promise:hover { transform: scale(1.02); box-shadow: 8px 8px 0 rgba(212,175,55,0.2); }
    .promise-icon {
      width: 44px; height: 44px; background: #d4af37; border-radius: 50%;
      display: flex; align-items: center; justify-content: center; color: #000;
      font-size: 1.3rem; flex-shrink: 0; border: 2px solid #000;
    }
    .promise-text h4 { font-size: 1rem; font-weight: 800; margin-bottom: 2px; color: #d4af37; }
    .promise-text p { font-size: 0.8rem; color: #eee; }

    .feature-grid-compact {
      display: grid; grid-template-columns: 1fr 1fr; gap: 12px;
    }
    .feature-item-compact {
      display: flex; align-items: center; gap: 8px; padding: 12px; background: #fafafa;
      border-radius: 16px; border: 2px solid #000; transition: all 0.2s;
    }
    .feature-item-compact:hover { background: #000; transform: translateY(-2px); }
    .feature-item-compact:hover .feature-text h4,
    .feature-item-compact:hover .feature-text p { color: #d4af37; }
    .feature-icon-small {
      width: 32px; height: 32px; background: #000; border-radius: 10px;
      display: flex; align-items: center; justify-content: center; color: #d4af37; border: 1px solid #d4af37;
    }
    .feature-text h4 { font-size: 0.8rem; font-weight: 800; color: #1e1e1e; }
    .feature-text p { font-size: 0.65rem; color: #555; font-weight: 500; }

    /* action buttons – flat 2D */
    .action-buttons { display: flex; flex-direction: column; gap: 12px; margin-bottom: 32px; }
    @media (min-width: 480px) { .action-buttons { flex-direction: row; } }
    .btn {
      flex: 1; padding: 16px; border-radius: 60px; font-weight: 800; font-size: 1rem;
      cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;
      transition: all 0.2s; text-transform: uppercase;
      border: 2px solid #000; background: #ffffff; color: #000;
      box-shadow: none;
    }
    .btn-primary {
      background: #000; color: #d4af37; border: 2px solid #d4af37;
    }
    .btn-primary:hover {
      background: #d4af37; color: #000; border-color: #000; transform: translateY(-2px);
    }
    .btn-secondary:hover {
      background: #000; color: #d4af37; border-color: #d4af37; transform: translateY(-2px);
    }

    /* tabs (below buttons) */
    .tabs {
      background: #ffffff; border-radius: 28px; padding: 24px; margin-bottom: 24px;
      border: 2px solid #000; box-shadow: 6px 6px 0 rgba(0,0,0,0.1);
      transition: all 0.3s;
    }
    .tabs:hover { box-shadow: 10px 10px 0 rgba(212,175,55,0.2); transform: translate(-2px, -2px); }
    .tab-headers {
      display: flex; gap: 24px; border-bottom: 2px solid #000; margin-bottom: 20px;
    }
    .tab-header {
      padding: 12px 0; cursor: pointer; font-weight: 700; color: #777;
      border-bottom: 3px solid transparent; transition: all 0.2s;
    }
    .tab-header:hover { color: #d4af37; }
    .tab-header.active { color: #000; border-bottom-color: #d4af37; }
    .tab-content { display: none; }
    .tab-content.active { display: block; animation: fadeIn 0.5s; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

    /* mobile reviews, related etc – unchanged structurally */
    .mobile-reviews {
      background: #ffffff; border-radius: 28px; padding: 24px; border: 2px solid #000;
      transition: all 0.3s;
    }
    @media (min-width: 1024px) { .mobile-reviews { display: none; } }

    .related { margin-top: 48px; padding-top: 32px; }
    .related-title { font-size: 2rem; font-weight: 800; margin-bottom: 24px; color: #000; text-transform: uppercase; }
    .related-grid {
      display: grid; grid-template-columns: repeat(2,1fr); gap: 16px;
    }
    @media (min-width:640px){ .related-grid { grid-template-columns: repeat(4,1fr); } }

    /* scroll top */
    .scroll-top {
      position: fixed; bottom: 20px; right: 20px; width: 52px; height: 52px;
      background: #000; color: #d4af37; border-radius: 50%; display: flex;
      align-items: center; justify-content: center; border: 2px solid #d4af37;
      cursor: pointer; opacity: 0; transition: all 0.3s; z-index: 90;
    }
    .scroll-top.visible { opacity: 1; }
    .scroll-top:hover { background: #d4af37; color: #000; transform: scale(1.1); }
  </style>
</head>
<body>

  <div id="header"></div>
  <div class="scroll-top" id="scrollTop" onclick="window.scrollTo({top:0,behavior:'smooth'})"><i class="fa-solid fa-arrow-up"></i></div>

  <main>
    <div class="container">
      <div class="breadcrumb">
        <a href="index.html">Home</a> <i class="fa-solid fa-chevron-right"></i>
        <a href="collection.html">Collection</a> <i class="fa-solid fa-chevron-right"></i>
        <span id="breadcrumb-product">Loading...</span>
      </div>
    </div>

    <div class="container" id="product-container"></div>
  </main>

  <div id="footer"></div>
  <div id="common-modals"></div>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyD16uGnm1vodkbqGoFSdFdJjGFSLpJmflk",
      authDomain: "myessantia.firebaseapp.com",
      projectId: "myessantia",
      storageBucket: "myessantia.firebasestorage.app",
      messagingSenderId: "701726517205",
      appId: "1:701726517205:web:f6ab79efdffeab6dbbbf5c"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let currentProduct = null;
    function getRandomSold() { return Math.floor(Math.random()*(2000-500+1))+500; }
    function getRandomViewers() { return Math.floor(Math.random()*(35-8+1))+8; }

    function generateReviews() {
      const users = [
        { name:'Priya Sharma', city:'Mumbai', avatar:'PS' }, { name:'Rahul Verma', city:'Delhi', avatar:'RV' },
        { name:'Ananya Patel', city:'Bangalore', avatar:'AP' }, { name:'Karthik Iyer', city:'Chennai', avatar:'KI' }
      ];
      const comments = ["Absolutely love this!","Perfect product","Great quality","Excellent value"];
      return users.map((u,i)=>({ ...u, comment:comments[i%4], rating:(4+Math.random()*0.9).toFixed(1), time:Math.floor(Math.random()*48)+1 }));
    }

    function getProductId() { return new URLSearchParams(window.location.search).get('id'); }

    async function loadProduct() {
      const pid = getProductId();
      if(!pid) return showNotFound();
      try {
        const doc = await db.collection('products').doc(pid).get();
        if(!doc.exists) return showNotFound();
        currentProduct = { id:doc.id, ...doc.data() };
        document.getElementById('breadcrumb-product').textContent = currentProduct.title;
        renderProduct(currentProduct);
        loadRelated(currentProduct);
      } catch(e){ console.error(e); showNotFound(); }
    }

    function showNotFound() {
      document.getElementById('product-container').innerHTML = `<div style="text-align:center; padding:60px 20px; background:white; border-radius:28px; border:2px solid #000;">Product not found</div>`;
    }

    function renderProduct(product) {
      const images = product.media?.images?.map(i=>i.url) || [product.primaryImg || 'https://images.unsplash.com/photo-1578500494198-246f612d3b3d?w=600'];
      const stock = product.stock || 10;
      const original = Math.round(product.price*1.25);
      const discount = Math.round(((original-product.price)/original)*100);
      const prepaid = Math.round(product.price*0.92);
      const cod = Math.round(product.price*1.04);
      const sold = getRandomSold();
      const live = getRandomViewers();
      const reviews = generateReviews();

      const container = document.getElementById('product-container');
      container.innerHTML = `
        <div class="product-grid">
          <!-- LEFT GALLERY -->
          <div class="gallery-section">
            <div class="main-image"><img src="${images[0]}" id="mainImage"></div>
            <div class="thumbnail-grid">${images.map((img,i)=>`<div class="thumbnail ${i===0?'active':''}" onclick="changeImage('${img}',this)"><img src="${img}"></div>`).join('')}</div>
            <div class="desktop-reviews"><div class="review-mini-card">...</div></div> <!-- simplified -->
          </div>

          <!-- RIGHT INFO -->
          <div class="product-info">
            <div class="social-strip"><span class="sold-badge"><i class="fa-solid fa-fire"></i> ${sold}+ sold</span><span class="live-badge"><i class="fa-solid fa-circle"></i> ${live} viewing</span></div>
            <div class="product-category">${product.category||'Accessories'}</div>
            <h1 class="product-title">${product.title}</h1>
            <div class="rating-row">
              <div class="stars">${getStars(product.rating)}</div><span>${(product.rating||4.5).toFixed(1)}</span><span>(128 reviews)</span>
              <div class="share-wrapper"><button class="share-btn" onclick="toggleShare(event)"><i class="fa-solid fa-share-alt"></i> Share</button><div class="share-menu" id="shareMenu"></div></div>
            </div>

            <!-- PRICE CARD with integrated quantity & stock -->
            <div class="price-card">
              <div class="price-header">
                <span class="current-price"><span class="inr-symbol">₹</span>${product.price.toFixed(2)}</span>
                <span class="original-price">₹${original.toFixed(2)}</span>
                <span class="discount">-${discount}%</span>
              </div>
              <div class="tax-info"><i class="fa-solid fa-receipt"></i> Taxes included. Shipping calculated at checkout.</div>
              <div class="price-options">
                <div class="price-option prepaid" onclick="smoothScrollToButtons()"><div class="option-label">Prepaid</div><div class="option-price">₹${prepaid}</div></div>
                <div class="price-option cod" onclick="smoothScrollToButtons()"><div class="option-label">Cash on Delivery</div><div class="option-price">₹${cod}</div></div>
              </div>
              <!-- quantity + stock inline -->
              <div class="quantity-stock-row">
                <div class="quantity-controls">
                  <button class="qty-btn" onclick="updateQuantity(-1)" ${stock===0?'disabled':''}>−</button>
                  <input type="text" class="qty-input" id="productQuantity" value="1" readonly>
                  <button class="qty-btn" onclick="updateQuantity(1)" ${stock===0?'disabled':''}>+</button>
                </div>
                <span class="stock-badge-inline"><i class="fa-solid ${stock>10?'fa-check-circle':'fa-exclamation-circle'}" style="color:#d4af37;"></i> ${stock>10?'In Stock':`Only ${stock} left`}</span>
              </div>
            </div>

            <!-- GROUPED CARD: delivery bar + razorpay + features -->
            <div class="info-group-card">
              <!-- delivery bar on top -->
              <div class="delivery-bar">
                <div class="delivery-header">
                  <span class="delivery-title"><i class="fa-solid fa-truck"></i> Free Delivery</span>
                  <span class="delivery-min">Min. ₹1,299</span>
                </div>
                <div class="progress-bar"><div class="progress-fill" id="deliveryProgress" style="width:${Math.min(100,(product.price/1299)*100)}%"></div></div>
                <div class="delivery-message" id="deliveryMessage">
                  <i class="fa-solid ${product.price>=1299?'fa-circle-check':'fa-circle-info'}" style="color:#d4af37;"></i>
                  <span id="deliveryText">${product.price>=1299?'You get free delivery!':`Add <span style="font-weight:800;color:#d4af37;">₹${(1299-product.price).toFixed(2)}</span> more`}</span>
                </div>
                <div class="delivery-eta"><i class="fa-regular fa-calendar"></i> Delivery by <span class="eta-bold">5–7 business days</span></div>
              </div>

              <!-- razorpay promise + feature items side by side -->
              <div class="promise-features-row">
                <div class="razorpay-promise">
                  <div class="promise-icon"><i class="fa-solid fa-shield"></i></div>
                  <div class="promise-text"><h4>Razorpay Promise</h4><p>100% refund on defects</p></div>
                </div>
                <div class="feature-grid-compact">
                  <div class="feature-item-compact"><div class="feature-icon-small"><i class="fa-solid fa-truck-fast"></i></div><div class="feature-text"><h4>Free Ship</h4><p>Above ₹1,299</p></div></div>
                  <div class="feature-item-compact"><div class="feature-icon-small"><i class="fa-solid fa-rotate-left"></i></div><div class="feature-text"><h4>Easy Returns</h4><p>48 hours</p></div></div>
                </div>
              </div>
            </div>

            <!-- ACTION BUTTONS (flat 2D) -->
            <div class="action-buttons" id="actionButtons">
              <button class="btn btn-secondary" onclick="addToCart()" ${stock===0?'disabled':''}><i class="fa-solid fa-cart-plus"></i> Add to Cart</button>
              <button class="btn btn-primary" onclick="buyNow()" ${stock===0?'disabled':''}><i class="fa-solid fa-bolt"></i> Buy Now</button>
            </div>

            <!-- TABS (description etc) below buttons -->
            <div class="tabs">
              <div class="tab-headers"><div class="tab-header active" onclick="switchTab('desc')">Description</div><div class="tab-header" onclick="switchTab('specs')">Specs</div><div class="tab-header" onclick="switchTab('videos')">Videos</div></div>
              <div class="tab-content active" id="tab-desc"><p>${product.description||'Premium quality'}</p></div>
              <div class="tab-content" id="tab-specs"><div class="specs-grid"><div class="spec-item">Material: Premium</div></div></div>
              <div class="tab-content" id="tab-videos"><div class="video-grid">...</div></div>
            </div>

            <!-- mobile reviews -->
            <div class="mobile-reviews">...</div>
          </div>
        </div>
      `;

      document.getElementById('shareMenu').innerHTML = `<div class="share-grid">...</div><div class="copy-link"><input id="shareLink" value="${window.location.href}"><button class="copy-btn">Copy</button></div>`;
      updateDeliveryBar(product.price);
      setupScrollTop();
    }

    // Helper functions
    function smoothScrollToButtons() {
      document.getElementById('actionButtons').scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
    window.smoothScrollToButtons = smoothScrollToButtons;

    function setupScrollTop() { const btn = document.getElementById('scrollTop'); window.addEventListener('scroll',()=>btn.classList.toggle('visible', window.scrollY>200)); }
    function getStars(r) { let s=''; for(let i=1;i<=5;i++) { if(r>=i) s+='<i class="fa-solid fa-star"></i>'; else if(r>i-1) s+='<i class="fa-solid fa-star-half-alt"></i>'; else s+='<i class="fa-regular fa-star"></i>'; } return s; }
    window.changeImage = (src,el)=>{ document.getElementById('mainImage').src=src; document.querySelectorAll('.thumbnail').forEach(t=>t.classList.remove('active')); el.classList.add('active'); };
    window.updateQuantity = (d)=>{ const inp=document.getElementById('productQuantity'); let v=parseInt(inp.value)+d; if(v<1)v=1; if(currentProduct && v>currentProduct.stock) v=currentProduct.stock; inp.value=v; updateDeliveryBar(currentProduct.price*v); };
    function updateDeliveryBar(t){ const p=document.getElementById('deliveryProgress'); const txt=document.getElementById('deliveryText'); if(!p||!txt)return; p.style.width=Math.min(100,(t/1299)*100)+'%'; txt.innerHTML = t>=1299 ? 'You get free delivery!' : `Add <span style="font-weight:800;color:#d4af37;">₹${(1299-t).toFixed(2)}</span> more`; }
    window.toggleShare = function(e){ e.stopPropagation(); document.getElementById('shareMenu').classList.toggle('show'); };
    window.addToCart = function(){ showNotification('Added to cart!'); };
    window.buyNow = function(){ addToCart(); setTimeout(()=>window.location.href='checkout.html',500); };
    function showNotification(m){ const n=document.createElement('div'); n.className='notification'; n.innerHTML=`<i class="fa-solid fa-check-circle"></i> ${m}`; document.body.appendChild(n); setTimeout(()=>n.remove(),2000); }
    window.switchTab = function(t){ document.querySelectorAll('.tab-header').forEach(h=>h.classList.remove('active')); document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active')); document.querySelector(`.tab-header[onclick="switchTab('${t}')"]`).classList.add('active'); document.getElementById(`tab-${t}`).classList.add('active'); };

    // Load common parts
    function loadComponents() {
      fetch('header.html').then(r=>r.text()).then(d=>document.getElementById('header').innerHTML=d).catch(()=>{});
      fetch('footer.html').then(r=>r.text()).then(d=>document.getElementById('footer').innerHTML=d).catch(()=>{});
    }
    document.addEventListener('DOMContentLoaded',()=>{ loadComponents(); loadProduct(); });
  </script>
</body>
</html>
